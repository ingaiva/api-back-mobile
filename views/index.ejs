<!DOCTYPE html>
<html>

<head>
  <title>
    <%= title %>
  </title>  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>
</head>

<body>
  <h1 class="text-center">
    <%= title %>
  </h1>
  <p  class="text-center">Bienvenu
  </p>

  <div >
    <a class="btn btn-primary m-3" href="/user/create">Créer un utilisateur</a>
  </div>
  <% if (!data || data.length===0) { %>
    <h2>Aucun utilisateur n'existe encore</h2>
  <% } else { %>

  <div class="m-3 p-2">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">Mail</th>
          <th scope="col">Nom</th>
          <th scope="col">Date de naissance</th>
          <th scope="col">genre</th>
          <th scope="col">pays</th>
          <th scope="col">Roles</th>
          <th scope="col">transactions</th>
          <th scope="col">...</th>
        </tr>
      </thead>
      <tbody>
        <%data.forEach((user)=> {%>
        <tr>
          <th><%= user.email %></th>
          <td><%= user.username %></td>
          <td><%= user.birthday? new Date(user.birthday).toLocaleDateString() : ''  %></td>
          <td><%= user.gender==='f' ? 'Femme' : 'Homme' %></td>
          <td><%= user.locale %></td>
          <td><%= user.roles?.join(', ') %></td>
          <td><%= user?.cptTransactions %></td>
          <td>
            <div class="d-flex">
              <a class="btn btn-primary mx-1" href="/user/view?id=<%= user._id %>">Gérer les transactions</a>
              <a class="btn btn-primary mx-1" href="/user/update?id=<%= user._id %>">Modifier</a>
              <a class="btn btn-danger mx-1" href="/user/delete?id=<%= user._id %>">Supprimer</a>
            </div>
          </td>
        </tr> 
        <%});%>       
      </tbody>
    </table>

  </div>
  <% } %>
</body>

</html>